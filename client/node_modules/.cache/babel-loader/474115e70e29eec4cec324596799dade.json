{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Drake Nguyen\\\\project\\\\test\\\\client\\\\src\\\\Chat\\\\Chat.js\";\nimport React, { useState, useEffect } from \"react\";\nimport socketClient from \"socket.io-client\";\nimport ChannelList from \"./ChannelList\";\nimport MessagesPanel from \"./MessagesPanel\";\nimport \"./chat.css\";\nconst SERVER = \"http://127.0.0.1:8080\";\nexport default function Chat() {\n  // let socket = socketClient(SERVER);\n  // socket.on(\"connection\", (value) => {\n  //   console.log(\"I am connected to server\");\n  // });\n  // // socket.on(\"channel\", (channel) => {\n  // //   let channelList = channels;\n  // //   channelList.forEach((c) => {\n  // //     if (c.id === channel.id) {\n  // //       c.participants = channel.participants;\n  // //     }\n  // //   });\n  // //   setChannels(channelList);\n  // // });\n  // const [channels, setChannels] = useState([\n  //   {\n  //     id: 1,\n  //     name: \"first\",\n  //     participants: 10,\n  //   },\n  // ]);\n  // const [id, setId] = useState(0);\n  // const loadChannel = async () => {\n  //   console.log(\"load channel running!\");\n  //   fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\n  //     let data = await response.json();\n  //     setChannels(data.channels);\n  //   });\n  // };\n  // const handleChannelSelect = (id) => {\n  //   setId(id);\n  //   socket.emit(\"channel-join\", id, (ack) => {});\n  // };\n  // useEffect(() => {\n  //   loadChannel();\n  // }, []);\n  // useEffect(() => {\n  //   socket.on(\"channel\", (channel) => {\n  //     let channelList = channels;\n  //     channelList.forEach((c) => {\n  //       if (c.id === channel.id) {\n  //         c.participants = channel.participants;\n  //       }\n  //     });\n  //     setChannels(channelList);\n  //   });\n  // }, [channels, socket]);\n  const [channels, setChannels] = useState(null);\n  const [socket, setSocket] = useState(null);\n  const [channel, setChannel] = useState(null);\n  useEffect(() => {\n    loadChannels();\n    configureSocket();\n  });\n\n  const loadChannels = async () => {\n    console.log(\"load channel running!\");\n    fetch(\"http://localhost:8080/getChannels\").then(async response => {\n      let data = await response.json();\n      setChannels(data.channels);\n    });\n  };\n\n  const configureSocket = () => {\n    var socket = socketClient(SERVER);\n    socket.on(\"connection\", () => {\n      if (channel) {\n        handleChannelSelect(channel.id);\n      }\n    });\n    socket.on(\"channel\", channel => {\n      let channels = channels;\n      channels.forEach(c => {\n        if (c.id === channel.id) {\n          c.participants = channel.participants;\n        }\n      });\n      setChannels(channels);\n    });\n    socket.on(\"message\", message => {\n      let channels = channels;\n      channels.forEach(c => {\n        if (c.id === message.channel_id) {\n          if (!c.messages) c.messages = [message];else c.message.push(message);\n        }\n      });\n    });\n    setSocket(socket);\n  };\n\n  const handleChannelSelect = id => {\n    let channel = channels.find(c => {\n      return c.id === id;\n    });\n    setChannel(channel);\n    socket.emit(\"channel-join\", id, ack => {});\n  };\n\n  const handleSendMessage = (channel_id, text) => {\n    socket.emit(\"send-message\", {\n      channel_id,\n      text,\n      senderName: socket.id,\n      id: Date.now()\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ChannelList, {\n    channels: channels,\n    onSelectChannel: handleChannelSelect,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(MessagesPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["C:/Users/Drake Nguyen/project/test/client/src/Chat/Chat.js"],"names":["React","useState","useEffect","socketClient","ChannelList","MessagesPanel","SERVER","Chat","channels","setChannels","socket","setSocket","channel","setChannel","loadChannels","configureSocket","console","log","fetch","then","response","data","json","on","handleChannelSelect","id","forEach","c","participants","message","channel_id","messages","push","find","emit","ack","handleSendMessage","text","senderName","Date","now"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport socketClient from \"socket.io-client\";\r\nimport ChannelList from \"./ChannelList\";\r\nimport MessagesPanel from \"./MessagesPanel\";\r\n\r\nimport \"./chat.css\";\r\n\r\nconst SERVER = \"http://127.0.0.1:8080\";\r\n\r\nexport default function Chat() {\r\n  // let socket = socketClient(SERVER);\r\n  // socket.on(\"connection\", (value) => {\r\n  //   console.log(\"I am connected to server\");\r\n  // });\r\n\r\n  // // socket.on(\"channel\", (channel) => {\r\n  // //   let channelList = channels;\r\n  // //   channelList.forEach((c) => {\r\n  // //     if (c.id === channel.id) {\r\n  // //       c.participants = channel.participants;\r\n  // //     }\r\n  // //   });\r\n  // //   setChannels(channelList);\r\n  // // });\r\n\r\n  // const [channels, setChannels] = useState([\r\n  //   {\r\n  //     id: 1,\r\n  //     name: \"first\",\r\n  //     participants: 10,\r\n  //   },\r\n  // ]);\r\n  // const [id, setId] = useState(0);\r\n\r\n  // const loadChannel = async () => {\r\n  //   console.log(\"load channel running!\");\r\n  //   fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\r\n  //     let data = await response.json();\r\n  //     setChannels(data.channels);\r\n  //   });\r\n  // };\r\n\r\n  // const handleChannelSelect = (id) => {\r\n  //   setId(id);\r\n  //   socket.emit(\"channel-join\", id, (ack) => {});\r\n  // };\r\n\r\n  // useEffect(() => {\r\n  //   loadChannel();\r\n  // }, []);\r\n\r\n  // useEffect(() => {\r\n  //   socket.on(\"channel\", (channel) => {\r\n  //     let channelList = channels;\r\n  //     channelList.forEach((c) => {\r\n  //       if (c.id === channel.id) {\r\n  //         c.participants = channel.participants;\r\n  //       }\r\n  //     });\r\n  //     setChannels(channelList);\r\n  //   });\r\n  // }, [channels, socket]);\r\n\r\n  const [channels, setChannels] = useState(null);\r\n  const [socket, setSocket] = useState(null);\r\n  const [channel, setChannel] = useState(null);\r\n\r\n  useEffect(() => {\r\n    loadChannels();\r\n    configureSocket();\r\n  });\r\n\r\n  const loadChannels = async () => {\r\n    console.log(\"load channel running!\");\r\n    fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\r\n      let data = await response.json();\r\n      setChannels(data.channels);\r\n    });\r\n  };\r\n\r\n  const configureSocket = () => {\r\n    var socket = socketClient(SERVER);\r\n    socket.on(\"connection\", () => {\r\n      if (channel) {\r\n        handleChannelSelect(channel.id);\r\n      }\r\n    });\r\n\r\n    socket.on(\"channel\", (channel) => {\r\n      let channels = channels;\r\n      channels.forEach((c) => {\r\n        if (c.id === channel.id) {\r\n          c.participants = channel.participants;\r\n        }\r\n      });\r\n      setChannels(channels);\r\n    });\r\n\r\n    socket.on(\"message\", (message) => {\r\n      let channels = channels;\r\n      channels.forEach((c) => {\r\n        if (c.id === message.channel_id) {\r\n          if (!c.messages) c.messages = [message];\r\n          else c.message.push(message);\r\n        }\r\n      });\r\n    });\r\n\r\n    setSocket(socket);\r\n  };\r\n\r\n  const handleChannelSelect = (id) => {\r\n    let channel = channels.find((c) => {\r\n      return c.id === id;\r\n    });\r\n    setChannel(channel);\r\n    socket.emit(\"channel-join\", id, (ack) => {});\r\n  };\r\n\r\n  const handleSendMessage = (channel_id, text) => {\r\n    socket.emit(\"send-message\", {\r\n      channel_id,\r\n      text,\r\n      senderName: socket.id,\r\n      id: Date.now(),\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"chat-app\">\r\n      <ChannelList channels={channels} onSelectChannel={handleChannelSelect} />\r\n      <MessagesPanel />\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}