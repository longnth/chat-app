{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Drake Nguyen\\\\project\\\\test\\\\client\\\\src\\\\Chat\\\\Chat.js\";\nimport React, { useState, useEffect } from \"react\";\nimport socketClient from \"socket.io-client\";\nimport ChannelList from \"./ChannelList\";\nimport MessagesPanel from \"./MessagesPanel\";\nimport \"./chat.css\";\nconst SERVER = \"http://127.0.0.1:8080\";\nexport default function Chat() {\n  let socket = socketClient(SERVER);\n  socket.on(\"connection\", value => {\n    console.log(\"I am connected to server\");\n  }); // socket.on(\"channel\", (channel) => {\n  //   let channelList = channels;\n  //   channelList.forEach((c) => {\n  //     if (c.id === channel.id) {\n  //       c.participants = channel.participants;\n  //     }\n  //   });\n  //   setChannels(channelList);\n  // });\n\n  const [channels, setChannels] = useState([{\n    id: 1,\n    name: \"first\",\n    participants: 10\n  }]);\n  const [id, setId] = useState(0);\n\n  const loadChannel = async () => {\n    console.log(\"load channel running!\");\n    fetch(\"http://localhost:8080/getChannels\").then(async response => {\n      let data = await response.json();\n      setChannels(data.channels);\n    });\n  };\n\n  const handleChannelSelect = id => {\n    setId(id);\n    socket.emit(\"channel-join\", id, ack => {});\n  };\n\n  const handleSelectedChannel = () => {\n    socket.on(\"channel\", channel => {\n      let channelList = channels;\n      channelList.forEach(c => {\n        if (c.id === channel.id) {\n          c.participants = channel.participants;\n        }\n      });\n      setChannels(channelList);\n    });\n  };\n\n  useEffect(() => {\n    loadChannel();\n  }, []);\n  useEffect(() => {\n    handleSelectedChannel();\n  }, [channels]); // const [channels, setChannels] = useState(null);\n  // const [socket, setSocket] = useState(null);\n  // const [channel, setChannel] = useState(null);\n  // useEffect(() => {\n  //   loadChannels();\n  //   configureSocket();\n  // });\n  // const loadChannels = async () => {\n  //   console.log(\"load channel running!\");\n  //   fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\n  //     let data = await response.json();\n  //     setChannels(data.channels);\n  //   });\n  // };\n  // const configureSocket = () => {\n  //   var socket = socketClient(SERVER);\n  //   socket.on(\"connection\", () => {\n  //     if (channel) {\n  //       handleChannelSelect(channel.id);\n  //     }\n  //   });\n  //   socket.on(\"channel\", (channel) => {\n  //     let channels = channels;\n  //     channels.forEach((c) => {\n  //       if (c.id === channel.id) {\n  //         c.participants = channel.participants;\n  //       }\n  //     });\n  //     setChannels(channels);\n  //   });\n  //   socket.on(\"message\", (message) => {\n  //     let channels = channels;\n  //     channels.forEach((c) => {\n  //       if (c.id === message.channel_id) {\n  //         if (!c.messages) c.messages = [message];\n  //         else c.message.push(message);\n  //       }\n  //     });\n  //   });\n  //   setSocket(socket);\n  // };\n  // const handleChannelSelect = (id) => {\n  //   let channel = channels.find((c) => {\n  //     return c.id === id;\n  //   });\n  //   setChannel(channel);\n  //   socket.emit(\"channel-join\", id, (ack) => {});\n  // };\n  // const handleSendMessage = (channel_id, text) => {\n  //   socket.emit(\"send-message\", {\n  //     channel_id,\n  //     text,\n  //     senderName: socket.id,\n  //     id: Date.now(),\n  //   });\n  // };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-app\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(ChannelList, {\n    channels: channels,\n    onSelectChannel: handleChannelSelect,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(MessagesPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["C:/Users/Drake Nguyen/project/test/client/src/Chat/Chat.js"],"names":["React","useState","useEffect","socketClient","ChannelList","MessagesPanel","SERVER","Chat","socket","on","value","console","log","channels","setChannels","id","name","participants","setId","loadChannel","fetch","then","response","data","json","handleChannelSelect","emit","ack","handleSelectedChannel","channel","channelList","forEach","c"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport socketClient from \"socket.io-client\";\r\nimport ChannelList from \"./ChannelList\";\r\nimport MessagesPanel from \"./MessagesPanel\";\r\n\r\nimport \"./chat.css\";\r\n\r\nconst SERVER = \"http://127.0.0.1:8080\";\r\n\r\nexport default function Chat() {\r\n  let socket = socketClient(SERVER);\r\n  socket.on(\"connection\", (value) => {\r\n    console.log(\"I am connected to server\");\r\n  });\r\n\r\n  // socket.on(\"channel\", (channel) => {\r\n  //   let channelList = channels;\r\n  //   channelList.forEach((c) => {\r\n  //     if (c.id === channel.id) {\r\n  //       c.participants = channel.participants;\r\n  //     }\r\n  //   });\r\n  //   setChannels(channelList);\r\n  // });\r\n\r\n  const [channels, setChannels] = useState([\r\n    {\r\n      id: 1,\r\n      name: \"first\",\r\n      participants: 10,\r\n    },\r\n  ]);\r\n  const [id, setId] = useState(0);\r\n\r\n  const loadChannel = async () => {\r\n    console.log(\"load channel running!\");\r\n    fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\r\n      let data = await response.json();\r\n      setChannels(data.channels);\r\n    });\r\n  };\r\n\r\n  const handleChannelSelect = (id) => {\r\n    setId(id);\r\n    socket.emit(\"channel-join\", id, (ack) => {});\r\n  };\r\n\r\n  const handleSelectedChannel = () => {\r\n    socket.on(\"channel\", (channel) => {\r\n      let channelList = channels;\r\n      channelList.forEach((c) => {\r\n        if (c.id === channel.id) {\r\n          c.participants = channel.participants;\r\n        }\r\n      });\r\n      setChannels(channelList);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadChannel();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    handleSelectedChannel();\r\n  }, [channels]);\r\n\r\n  // const [channels, setChannels] = useState(null);\r\n  // const [socket, setSocket] = useState(null);\r\n  // const [channel, setChannel] = useState(null);\r\n\r\n  // useEffect(() => {\r\n  //   loadChannels();\r\n  //   configureSocket();\r\n  // });\r\n\r\n  // const loadChannels = async () => {\r\n  //   console.log(\"load channel running!\");\r\n  //   fetch(\"http://localhost:8080/getChannels\").then(async (response) => {\r\n  //     let data = await response.json();\r\n  //     setChannels(data.channels);\r\n  //   });\r\n  // };\r\n\r\n  // const configureSocket = () => {\r\n  //   var socket = socketClient(SERVER);\r\n  //   socket.on(\"connection\", () => {\r\n  //     if (channel) {\r\n  //       handleChannelSelect(channel.id);\r\n  //     }\r\n  //   });\r\n\r\n  //   socket.on(\"channel\", (channel) => {\r\n  //     let channels = channels;\r\n  //     channels.forEach((c) => {\r\n  //       if (c.id === channel.id) {\r\n  //         c.participants = channel.participants;\r\n  //       }\r\n  //     });\r\n  //     setChannels(channels);\r\n  //   });\r\n\r\n  //   socket.on(\"message\", (message) => {\r\n  //     let channels = channels;\r\n  //     channels.forEach((c) => {\r\n  //       if (c.id === message.channel_id) {\r\n  //         if (!c.messages) c.messages = [message];\r\n  //         else c.message.push(message);\r\n  //       }\r\n  //     });\r\n  //   });\r\n\r\n  //   setSocket(socket);\r\n  // };\r\n\r\n  // const handleChannelSelect = (id) => {\r\n  //   let channel = channels.find((c) => {\r\n  //     return c.id === id;\r\n  //   });\r\n  //   setChannel(channel);\r\n  //   socket.emit(\"channel-join\", id, (ack) => {});\r\n  // };\r\n\r\n  // const handleSendMessage = (channel_id, text) => {\r\n  //   socket.emit(\"send-message\", {\r\n  //     channel_id,\r\n  //     text,\r\n  //     senderName: socket.id,\r\n  //     id: Date.now(),\r\n  //   });\r\n  // };\r\n\r\n  return (\r\n    <div className=\"chat-app\">\r\n      <ChannelList channels={channels} onSelectChannel={handleChannelSelect} />\r\n      <MessagesPanel />\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}